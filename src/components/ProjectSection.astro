---
import PlaceholderImage from "./PlaceholderImage.astro";

interface Props {
    title: string;
    id?: string;
    placeholder?: boolean; /* If true, adds a placeholder image at bottom */
}

const { title, id, placeholder = false } = Astro.props;
---

<section class="project-section" id={id}>
    <div class="header-group">
        <div class="section-title">
            <h3>{title}</h3>
        </div>
        <div class="section-content">
            <slot />
        </div>
    </div>
    {
        placeholder && (
            <div class="section-image">
                <PlaceholderImage height="400px" />
            </div>
        )
    }
</section>

<style>
    /* ===========================================
       PROJECT SECTION LAYOUT
       ===========================================
       This is a simple 2-column layout:
       - Left column: Section title (sticky)
       - Right column: Content (text, images, etc.)
       
       KEY SPACING VARIABLES (edit these to adjust):
    */

    /* --- SPACING CONTROLS --- */
    .project-section {
        --title-width: 160px; /* Width of the title column */
        --column-gap: 16px; /* Gap between title and content */
        --section-margin: 3rem; /* Space between sections */
        --image-spacing: 16px; /* Space above images */

        display: flex;
        flex-direction: column;
        margin-bottom: var(--section-margin);
    }

    /* --- HEADER GRID (Title + Text) --- */
    .header-group {
        display: grid;
        grid-template-columns: var(--title-width) 1fr;
        gap: var(--column-gap);
        align-items: start;
        overflow: visible; /* Allow images to break out of grid cell */
    }

    /* --- TITLE STYLING --- */
    .section-title h3 {
        font-size: 0.75rem;
        font-weight: 600;
        color: var(--text-primary);
        line-height: 1.4;
        letter-spacing: -0.01em;
        margin: 0;
        position: sticky;
        top: 2rem;
    }

    /* --- CONTENT STYLING --- */
    .section-content {
        font-size: 0.75rem;
        line-height: 1.4;
        color: var(--text-secondary);
        font-family: "Inter", sans-serif;
    }

    /* First paragraph aligns with title (no extra margin) */
    .section-content > :global(*:first-child) {
        margin-top: 0;
    }

    /* --- IMAGE STYLING --- */
    .section-image {
        margin-top: var(--image-spacing);
        width: 100%;
    }

    /* Keep support for manual images inside content if needed */
    .section-content :global(img),
    .section-content :global(video),
    .section-content :global(.placeholder-container) {
        /* Break out of content column to span full section width */
        margin-left: calc(-1 * (var(--title-width) + var(--column-gap)));
        width: calc(100% + var(--title-width) + var(--column-gap));
        max-width: none;
        display: block;
        border-radius: var(--radius-sm);
        margin-top: var(--image-spacing);
        margin-bottom: 1rem;
    }

    .section-content :global(.grid-2) {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-top: var(--image-spacing);
    }

    .section-content :global(.grid-3) {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
        margin-top: var(--image-spacing);
    }

    /* --- MOBILE LAYOUT --- */
    @media (max-width: 768px) {
        .header-group {
            grid-template-columns: 1fr; /* Stack title/text vertically */
            gap: 0.5rem;
        }

        .project-section {
            margin-bottom: 4rem;
        }

        .section-title h3 {
            position: static;
            margin-bottom: 0.5rem;
        }
    }
</style>
