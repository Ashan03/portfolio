---
import PlaceholderImage from "./PlaceholderImage.astro";

interface Props {
    title: string;
    id?: string;
    placeholder?: boolean; /* If true, adds a placeholder image at bottom */
    hideTitle?: boolean; /* If true, hides title and divider for continuation sections */
    group?: string; /* ID of the parent section for sidebar highlighting */
}

const {
    title,
    id,
    placeholder = false,
    hideTitle = false,
    group,
} = Astro.props;
---

<section class="project-section" id={id} data-toc-group={group}>
    <div class="hero-text-container">
        <div class:list={["header-group", { continuation: hideTitle }]}>
            <div class="section-title">
                {!hideTitle && <h3>{title}</h3>}
            </div>
            <div class="section-content">
                <slot />
            </div>
        </div>
    </div>
    {
        placeholder && (
            <div class="section-image">
                <PlaceholderImage height="400px" />
            </div>
        )
    }
</section>

<style>
    /* ===========================================
       PROJECT SECTION LAYOUT
       ===========================================
       This is a simple 2-column layout:
       - Left column: Section title (sticky)
       - Right column: Content (text, images, etc.)
       
       KEY SPACING VARIABLES (edit these to adjust):
    */

    /* --- SPACING CONTROLS --- */
    .project-section {
        --title-width: 200px; /* Width of the title column */
        --column-gap: 32px; /* Gap between title and content */
        --section-margin: 1rem; /* Reduced space between sections */
        --image-spacing: 24px; /* Space above images */

        display: flex;
        flex-direction: column;
        margin-bottom: var(--section-margin);
    }

    /* --- HERO TEXT CONTAINER (Centered on Desktop) --- */
    .hero-text-container {
        width: 100%;
        margin: 0 auto;
        padding-inline: max(
            0rem,
            calc(50% - 450px)
        ); /* Centers text to 900px */
        box-sizing: border-box;
    }

    /* --- HEADER GRID (Title + Text) --- */
    .header-group {
        display: flex;
        flex-direction: column;
        gap: 0.8rem; /* Vertical gap between title and content */
        overflow: visible;

        /* Divider Line */
        border-top: 1px solid var(--border-subtle, rgba(0, 0, 0, 0.1));
        padding-top: 0.75rem; /* Reduced to 12px */
    }

    /* Hide divider for continuation sections */
    .header-group.continuation {
        border-top: none;
        padding-top: 0;
    }

    /* --- TITLE STYLING (Section Subheadings) --- */
    .section-title h3 {
        font-size: 1.75rem; /* 28px */
        font-weight: 800;
        color: var(--text-primary);
        line-height: 1.3;
        letter-spacing: -0.02em;
        margin: 0;
        /* Removed sticky positioning for vertical layout */
        font-family: "Public Sans", sans-serif;
    }

    /* --- CONTENT STYLING (Body Text) --- */
    .section-content {
        font-size: 1rem; /* 16px */
        line-height: 1.4; /* Reduced line spacing */
        font-weight: 300; /* Light */
        color: var(--text-secondary);
        font-family: "Public Sans", sans-serif;
    }

    /* Style nested h3 headings within content */
    .section-content :global(h3) {
        font-size: 1rem; /* 16px for sub-subheadings */
        font-weight: 500; /* Normal */
        color: var(--text-primary);
        margin-top: 1.5rem;
        margin-bottom: 0.5rem;
        font-family: "Public Sans", sans-serif;
    }

    /* First paragraph aligns with title (no extra margin) */
    .section-content > :global(*:first-child) {
        margin-top: 0;
    }

    /* --- IMAGE STYLING --- */
    .section-image {
        margin-top: var(--image-spacing);
        width: 100%;
    }

    /* Style strong/bold text: Underlined and normal weight */
    .section-content :global(strong),
    .section-content :global(b) {
        font-weight: inherit;
        text-decoration: underline;
        color: inherit;
    }

    /* Images inside content are constrained to text box width */
    .section-content :global(img),
    .section-content :global(video),
    .section-content :global(.placeholder-container) {
        width: 100%;
        max-width: 100%;
        display: block;
        border-radius: var(--radius-sm);
        margin-top: var(--image-spacing);
        margin-bottom: 1rem;
    }

    .section-content :global(.grid-2) {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-top: var(--image-spacing);
    }

    .section-content :global(.grid-3) {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
        margin-top: var(--image-spacing);
    }

    /* --- MOBILE LAYOUT --- */
    @media (max-width: 768px) {
        .header-group {
            grid-template-columns: 1fr; /* Stack title/text vertically */
            gap: 0.5rem;
        }

        .project-section {
            margin-bottom: 3rem;
        }

        .section-title h3 {
            position: static;
            margin-bottom: 0.5rem;
            font-size: 1.125rem; /* 18px */
        }

        .section-content {
            font-size: 0.75rem; /* 12px */
        }

        /* Reset image breakout for mobile stack */
        .section-content :global(img),
        .section-content :global(video),
        .section-content :global(.placeholder-container) {
            width: 100%;
            margin-left: 0;
        }
    }

    /* --- TABLET/MOBILE: Fluid container --- */
    @media (max-width: 1024px) {
        .hero-text-container {
            width: 100%;
        }
    }

    /* --- GLOBAL HELPERS FOR CONTENT --- */
    /* Centered Tagline (Responsive) */
    .section-content :global(.centered-tagline) {
        text-align: center;
        font-weight: 500;
        font-size: 20px;
        line-height: 1.4;
        margin: 1.5rem 0;
        color: var(--text-primary);
    }

    @media (max-width: 768px) {
        .section-content :global(.centered-tagline) {
            font-size: 14px;
        }
    }

    /* Bento Button Link */
    .section-content :global(.bento-button) {
        display: inline-flex;
        align-items: center;
        background: var(--bg-secondary);
        border: 1px solid var(--border-subtle, rgba(0, 0, 0, 0.1));
        padding: 4px 12px;
        border-radius: 8px;
        color: var(
            --accent-secondary
        ); /* Dark grey for contrast against light surface */
        text-decoration: none;
        font-size: 0.9em;
        font-weight: 500;
        transition: all 0.2s ease;
        margin: 0 4px;
        vertical-align: middle;
    }

    .section-content :global(.bento-button:hover) {
        background: var(--bg-surface-hover);
        transform: translateY(-1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        color: #ee6b02;
    }
</style>
